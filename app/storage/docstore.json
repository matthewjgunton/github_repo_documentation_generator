{"docstore/metadata": {"5b6a0652566d10360493952aec6d4a4febc77083": {"doc_hash": "0a8108b2f211606ca0fa72c3baf676b0244055e26a1f3822be636eb0654c0dd5"}, "8e3c2ebc99e2e337f7d69948b93529a437590b27": {"doc_hash": "8b595bec723a6918e321c2cd78235b5f7294de11b75b3ca615fa153fddacde94"}, "8160af5a9ec81dfa66df153ed6bf8d2fcd359821": {"doc_hash": "a1d9102acddba8ae4dd58181d490547325afd04dda80023587d9db831ab22b19"}, "855f0918ae74cbe79073837aea20f81d2d54132e": {"doc_hash": "bbfb2928b2cf74629fc9475dd12a30a673c5995342ad202af73e7526deb0b4e2"}, "c3fe9a53-469a-44a7-a05f-ab38afb89f0a": {"doc_hash": "da9596877c48c8e6e71ed1317ca3cc419861442da59b80c111899c3a1e6df9bb", "ref_doc_id": "5b6a0652566d10360493952aec6d4a4febc77083"}, "1b8939b7-6709-4279-a121-881982d21c92": {"doc_hash": "35a69407d0b982a9561ab1c8a7c64410f5cc428dc83c78b6d09aa944897165b4", "ref_doc_id": "8e3c2ebc99e2e337f7d69948b93529a437590b27"}, "50a010c1-1150-47d0-b78c-e62da7db9a4f": {"doc_hash": "5647da9b488b89db4ce62328eaff44f938ff55a2fd3657469ca89b46c7183566", "ref_doc_id": "8160af5a9ec81dfa66df153ed6bf8d2fcd359821"}, "cfa92e11-7d1c-4ec0-85cc-b48e18a0b8ea": {"doc_hash": "5301602e317d266953086b3ea8889dfcfc0f9b38d9037c37055ef2108ab1d387", "ref_doc_id": "855f0918ae74cbe79073837aea20f81d2d54132e"}, "f374a9f5-5f92-4f78-9e25-7beb86a59958": {"doc_hash": "d1ab6afd957c75593afc18fdecfbce9eaf76fc08f467c19b0941c44976c8275b", "ref_doc_id": "855f0918ae74cbe79073837aea20f81d2d54132e"}}, "docstore/data": {"c3fe9a53-469a-44a7-a05f-ab38afb89f0a": {"__data__": {"id_": "c3fe9a53-469a-44a7-a05f-ab38afb89f0a", "embedding": null, "metadata": {"file_path": ".gitignore", "file_name": ".gitignore", "url": "https://github.com/ng4567/LM2APA/blob/20af215c907c06910edd41e0de847979a8e29a91/.gitignore"}, "excluded_embed_metadata_keys": [], "excluded_llm_metadata_keys": [], "relationships": {"1": {"node_id": "5b6a0652566d10360493952aec6d4a4febc77083", "node_type": "4", "metadata": {"file_path": ".gitignore", "file_name": ".gitignore", "url": "https://github.com/ng4567/LM2APA/blob/20af215c907c06910edd41e0de847979a8e29a91/.gitignore"}, "hash": "0a8108b2f211606ca0fa72c3baf676b0244055e26a1f3822be636eb0654c0dd5", "class_name": "RelatedNodeInfo"}, "3": {"node_id": "1b8939b7-6709-4279-a121-881982d21c92", "node_type": "1", "metadata": {}, "hash": "54a9df38d69dea63691fa5331f5895983e28d99e66755475f4c2d8f495fa8c47", "class_name": "RelatedNodeInfo"}}, "text": ".Rproj.user\n.Rhistory\n.RData\n.Ruserdata", "start_char_idx": 0, "end_char_idx": 39, "text_template": "{metadata_str}\n\n{content}", "metadata_template": "{key}: {value}", "metadata_seperator": "\n", "class_name": "TextNode"}, "__type__": "1"}, "1b8939b7-6709-4279-a121-881982d21c92": {"__data__": {"id_": "1b8939b7-6709-4279-a121-881982d21c92", "embedding": null, "metadata": {"file_path": "LM2APA.Rproj", "file_name": "LM2APA.Rproj", "url": "https://github.com/ng4567/LM2APA/blob/20af215c907c06910edd41e0de847979a8e29a91/LM2APA.Rproj"}, "excluded_embed_metadata_keys": [], "excluded_llm_metadata_keys": [], "relationships": {"1": {"node_id": "8e3c2ebc99e2e337f7d69948b93529a437590b27", "node_type": "4", "metadata": {"file_path": "LM2APA.Rproj", "file_name": "LM2APA.Rproj", "url": "https://github.com/ng4567/LM2APA/blob/20af215c907c06910edd41e0de847979a8e29a91/LM2APA.Rproj"}, "hash": "8b595bec723a6918e321c2cd78235b5f7294de11b75b3ca615fa153fddacde94", "class_name": "RelatedNodeInfo"}, "2": {"node_id": "c3fe9a53-469a-44a7-a05f-ab38afb89f0a", "node_type": "1", "metadata": {"file_path": ".gitignore", "file_name": ".gitignore", "url": "https://github.com/ng4567/LM2APA/blob/20af215c907c06910edd41e0de847979a8e29a91/.gitignore"}, "hash": "da9596877c48c8e6e71ed1317ca3cc419861442da59b80c111899c3a1e6df9bb", "class_name": "RelatedNodeInfo"}, "3": {"node_id": "50a010c1-1150-47d0-b78c-e62da7db9a4f", "node_type": "1", "metadata": {}, "hash": "71bd49bce258acf68cfdb3d0f7a44b81d63571e6baa95229ea0a36b17e0b223f", "class_name": "RelatedNodeInfo"}}, "text": "Version: 1.0\n\nRestoreWorkspace: Default\nSaveWorkspace: Default\nAlwaysSaveHistory: Default\n\nEnableCodeIndexing: Yes\nUseSpacesForTab: Yes\nNumSpacesForTab: 2\nEncoding: UTF-8\n\nRnwWeave: Sweave\nLaTeX: pdfLaTeX", "start_char_idx": 0, "end_char_idx": 204, "text_template": "{metadata_str}\n\n{content}", "metadata_template": "{key}: {value}", "metadata_seperator": "\n", "class_name": "TextNode"}, "__type__": "1"}, "50a010c1-1150-47d0-b78c-e62da7db9a4f": {"__data__": {"id_": "50a010c1-1150-47d0-b78c-e62da7db9a4f", "embedding": null, "metadata": {"file_path": "README.md", "file_name": "README.md", "url": "https://github.com/ng4567/LM2APA/blob/20af215c907c06910edd41e0de847979a8e29a91/README.md"}, "excluded_embed_metadata_keys": [], "excluded_llm_metadata_keys": [], "relationships": {"1": {"node_id": "8160af5a9ec81dfa66df153ed6bf8d2fcd359821", "node_type": "4", "metadata": {"file_path": "README.md", "file_name": "README.md", "url": "https://github.com/ng4567/LM2APA/blob/20af215c907c06910edd41e0de847979a8e29a91/README.md"}, "hash": "a1d9102acddba8ae4dd58181d490547325afd04dda80023587d9db831ab22b19", "class_name": "RelatedNodeInfo"}, "2": {"node_id": "1b8939b7-6709-4279-a121-881982d21c92", "node_type": "1", "metadata": {"file_path": "LM2APA.Rproj", "file_name": "LM2APA.Rproj", "url": "https://github.com/ng4567/LM2APA/blob/20af215c907c06910edd41e0de847979a8e29a91/LM2APA.Rproj"}, "hash": "35a69407d0b982a9561ab1c8a7c64410f5cc428dc83c78b6d09aa944897165b4", "class_name": "RelatedNodeInfo"}, "3": {"node_id": "cfa92e11-7d1c-4ec0-85cc-b48e18a0b8ea", "node_type": "1", "metadata": {}, "hash": "8b8b093259af83e4e5f38d9b07cf63cd54f94b0469c443579397ab424350cd36", "class_name": "RelatedNodeInfo"}}, "text": "# LM2APA\n\n  This R package is used to create Microsoft Word documents containing graphs frequently used in checking Linear Regression model assumptions, and regression table outputs in APA format.\n\n  The only function in the package is **make_lm_plots()**, and it takes the parameters: model, output_path, reg_table, reg_table_name \n\n* **model**: lm object to pass to the function\n* **output_path**: path of where you would like the graphs to be saved \n* **reg_table**: binary variable to indicate if you would like the regression table to also be made (1=Yes, 2=no)\n* **reg_table_name**: name of word document containing table (will be .doc not .docx)\n\n# Example code \n\nIf you want to include a regression table:\n\nmod <- lm(mpg ~ wt, data = mtcars)\nmake_lm_plots(mod, \"test.docx\", 1, \"table.doc\")\n\nNo Regression table:\n\nmod <- lm(mpg ~ wt, data = mtcars)\nmake_lm_plots(mod, \"2.docx\")", "start_char_idx": 0, "end_char_idx": 884, "text_template": "{metadata_str}\n\n{content}", "metadata_template": "{key}: {value}", "metadata_seperator": "\n", "class_name": "TextNode"}, "__type__": "1"}, "cfa92e11-7d1c-4ec0-85cc-b48e18a0b8ea": {"__data__": {"id_": "cfa92e11-7d1c-4ec0-85cc-b48e18a0b8ea", "embedding": null, "metadata": {"file_path": "package.R", "file_name": "package.R", "url": "https://github.com/ng4567/LM2APA/blob/20af215c907c06910edd41e0de847979a8e29a91/package.R"}, "excluded_embed_metadata_keys": [], "excluded_llm_metadata_keys": [], "relationships": {"1": {"node_id": "855f0918ae74cbe79073837aea20f81d2d54132e", "node_type": "4", "metadata": {"file_path": "package.R", "file_name": "package.R", "url": "https://github.com/ng4567/LM2APA/blob/20af215c907c06910edd41e0de847979a8e29a91/package.R"}, "hash": "bbfb2928b2cf74629fc9475dd12a30a673c5995342ad202af73e7526deb0b4e2", "class_name": "RelatedNodeInfo"}, "2": {"node_id": "50a010c1-1150-47d0-b78c-e62da7db9a4f", "node_type": "1", "metadata": {"file_path": "README.md", "file_name": "README.md", "url": "https://github.com/ng4567/LM2APA/blob/20af215c907c06910edd41e0de847979a8e29a91/README.md"}, "hash": "5647da9b488b89db4ce62328eaff44f938ff55a2fd3657469ca89b46c7183566", "class_name": "RelatedNodeInfo"}, "3": {"node_id": "f374a9f5-5f92-4f78-9e25-7beb86a59958", "node_type": "1", "metadata": {}, "hash": "27b6ee9766ff0b1efc0ed90103492fceec1771caffd6dda6718d32117660b120", "class_name": "RelatedNodeInfo"}}, "text": "library(ggplot2)\nlibrary(apaTables)\nlibrary(officer)\n\nmake_lm_plots<-function(model, output_path, reg_table, reg_table_name){\n  word_doc <- read_docx()\n  p1<-ggplot(model, aes(.fitted, .resid))+geom_point()\n  p1<-p1+stat_smooth(method=\"loess\")+geom_hline(yintercept=0, col=\"red\", linetype=\"dashed\")\n  p1<-p1+xlab(\"Fitted values\")+ylab(\"Residuals\")\n  p1<-p1+ggtitle(\"Residual vs Fitted Plot\")+theme_bw()\n  \n  ggsave(\"FittedvResid.png\",\n         p1,\n         width = 4,\n         height = 3,\n         units = \"in\")\n  word_doc <- body_add_img(word_doc,\n                           src = \"FittedvResid.png\",\n                           width = 4,\n                           height = 3)\n  \n  p3<-ggplot(model, aes(.fitted, sqrt(abs(.stdresid))))+geom_point(na.rm=TRUE)\n  p3<-p3+stat_smooth(method=\"loess\", na.rm = TRUE)+xlab(\"Fitted Value\")\n  p3<-p3+ylab(expression(sqrt(\"|Standardized residuals|\")))\n  p3<-p3+ggtitle(\"Scale-Location\")+theme_bw()\n  \n  ggsave(\"Scale-Location.png\",\n         p3,\n         width = 4,\n         height = 3,\n         units = \"in\")\n  word_doc <- body_add_img(word_doc,\n                           src = \"Scale-Location.png\",\n                           width = 4,\n                           height = 3)\n  \n  p4<-ggplot(model, aes(seq_along(.cooksd), .cooksd))+geom_bar(stat=\"identity\", position=\"identity\")\n  p4<-p4+xlab(\"Obs.", "start_char_idx": 0, "end_char_idx": 1342, "text_template": "{metadata_str}\n\n{content}", "metadata_template": "{key}: {value}", "metadata_seperator": "\n", "class_name": "TextNode"}, "__type__": "1"}, "f374a9f5-5f92-4f78-9e25-7beb86a59958": {"__data__": {"id_": "f374a9f5-5f92-4f78-9e25-7beb86a59958", "embedding": null, "metadata": {"file_path": "package.R", "file_name": "package.R", "url": "https://github.com/ng4567/LM2APA/blob/20af215c907c06910edd41e0de847979a8e29a91/package.R"}, "excluded_embed_metadata_keys": [], "excluded_llm_metadata_keys": [], "relationships": {"1": {"node_id": "855f0918ae74cbe79073837aea20f81d2d54132e", "node_type": "4", "metadata": {"file_path": "package.R", "file_name": "package.R", "url": "https://github.com/ng4567/LM2APA/blob/20af215c907c06910edd41e0de847979a8e29a91/package.R"}, "hash": "bbfb2928b2cf74629fc9475dd12a30a673c5995342ad202af73e7526deb0b4e2", "class_name": "RelatedNodeInfo"}, "2": {"node_id": "cfa92e11-7d1c-4ec0-85cc-b48e18a0b8ea", "node_type": "1", "metadata": {"file_path": "package.R", "file_name": "package.R", "url": "https://github.com/ng4567/LM2APA/blob/20af215c907c06910edd41e0de847979a8e29a91/package.R"}, "hash": "5301602e317d266953086b3ea8889dfcfc0f9b38d9037c37055ef2108ab1d387", "class_name": "RelatedNodeInfo"}}, "text": "Number\")+ylab(\"Cook's distance\")\n  p4<-p4+ggtitle(\"Cook's distance\")+theme_bw()\n  \n  ggsave(\"Cook's distance.png\",\n         p4,\n         width = 4,\n         height = 3,\n         units = \"in\")\n  word_doc <- body_add_img(word_doc,\n                           src = \"Cook's distance.png\",\n                           width = 4,\n                           height = 3)\n  \n  p5<-ggplot(model, aes(.hat, .stdresid))+geom_point(aes(size=.cooksd), na.rm=TRUE)\n  p5<-p5+stat_smooth(method=\"loess\", na.rm=TRUE)\n  p5<-p5+xlab(\"Leverage\")+ylab(\"Standardized Residuals\")\n  p5<-p5+ggtitle(\"Residual vs Leverage Plot\")\n  p5<-p5+scale_size_continuous(\"Cook's Distance\", range=c(1,5))\n  p5<-p5+theme_bw()+theme(legend.position=\"bottom\")\n  \n  ggsave(\"Residual vs Leverage Plot.png\",\n         p5,\n         width = 4,\n         height = 3,\n         units = \"in\")\n  word_doc <- body_add_img(word_doc,\n                           src = \"Residual vs Leverage Plot.png\",\n                           width = 4,\n                           height = 3)\n  \n  p6<-ggplot(model, aes(.hat, .cooksd))+geom_point(na.rm=TRUE)+stat_smooth(method=\"loess\", na.rm=TRUE)\n  p6<-p6+xlab(\"Leverage hii\")+ylab(\"Cook's Distance\")\n  p6<-p6+ggtitle(\"Cook's dist vs Leverage hii/(1-hii)\")\n  p6<-p6+geom_abline(slope=seq(0,3,0.5), color=\"gray\", linetype=\"dashed\")\n  p6<-p6+theme_bw()\n  \n  ggsave(\"Cook's dist vs Leverage.png\",\n         p6,\n         width = 4,\n         height = 3,\n         units = \"in\")\n  word_doc <- body_add_img(word_doc,\n                           src = \"Cook's dist vs Leverage.png\",\n                           width = 4,\n                           height = 3)\n  \n  print(word_doc, target = output_path)\n  unlink(\"Cook's dist vs Leverage.png\")\n  unlink(\"Cook's distance.png\")\n  unlink(\"FittedvResid.png\")\n  unlink(\"Scale-Location.png\")\n  unlink(\"Residual vs Leverage Plot.png\")\n  \n  if(reg_table == 1){\n    apa.reg.table(\n      mod,\n      filename = reg_table_name,\n      table.number = NA,\n      prop.var.conf.level = 0.95\n    )\n  }\n}\n\n#Example code\nmod <- lm(mpg ~ wt, data = mtcars)\n\nmake_lm_plots(mod, \"test.docx\", 1, \"table.doc\")\n\n#ggplot code from:\n#https://rpubs.com/therimalaya/43190\n\n#helpful YT video with officeR tutorial:\n#https://www.youtube.com/watch?v=HCc3z9BGpJQ", "start_char_idx": 1343, "end_char_idx": 3587, "text_template": "{metadata_str}\n\n{content}", "metadata_template": "{key}: {value}", "metadata_seperator": "\n", "class_name": "TextNode"}, "__type__": "1"}}, "docstore/ref_doc_info": {"5b6a0652566d10360493952aec6d4a4febc77083": {"node_ids": ["c3fe9a53-469a-44a7-a05f-ab38afb89f0a"], "metadata": {"file_path": ".gitignore", "file_name": ".gitignore", "url": "https://github.com/ng4567/LM2APA/blob/20af215c907c06910edd41e0de847979a8e29a91/.gitignore"}}, "8e3c2ebc99e2e337f7d69948b93529a437590b27": {"node_ids": ["1b8939b7-6709-4279-a121-881982d21c92"], "metadata": {"file_path": "LM2APA.Rproj", "file_name": "LM2APA.Rproj", "url": "https://github.com/ng4567/LM2APA/blob/20af215c907c06910edd41e0de847979a8e29a91/LM2APA.Rproj"}}, "8160af5a9ec81dfa66df153ed6bf8d2fcd359821": {"node_ids": ["50a010c1-1150-47d0-b78c-e62da7db9a4f"], "metadata": {"file_path": "README.md", "file_name": "README.md", "url": "https://github.com/ng4567/LM2APA/blob/20af215c907c06910edd41e0de847979a8e29a91/README.md"}}, "855f0918ae74cbe79073837aea20f81d2d54132e": {"node_ids": ["cfa92e11-7d1c-4ec0-85cc-b48e18a0b8ea", "f374a9f5-5f92-4f78-9e25-7beb86a59958"], "metadata": {"file_path": "package.R", "file_name": "package.R", "url": "https://github.com/ng4567/LM2APA/blob/20af215c907c06910edd41e0de847979a8e29a91/package.R"}}}}